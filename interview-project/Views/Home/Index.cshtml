@using interview_project.Database.Entities;
@model List<Company>

@{
    ViewData["Title"] = "Home Page";
    var currentIsin = ViewData["Isin"] as string;
    var currentId = ViewData["CompanyId"] as string;
}

<html lang="en">
<head>
    <link rel="stylesheet" href="site.css">
    <link rel="stylesheet" href="~/css/Home.css">
</head>

<body>
    <div class="text-center">
        <div class="info">
            <h1 class="display-4">Welcome</h1>
            <div class="actions">
                <button onclick="createCompany()" class="button btn btn-primary">Add company</button>
                <form asp-controller="Account" asp-action="Logout" method="post" style="display:inline;">
                    @Html.AntiForgeryToken()
                    <button type="submit" class="button btn btn-secondary">Logout</button>
                </form>
            </div>

            <form method="get" action="@Url.Action("Index")" class="mb-3">
                <input class="input" type="text" id="isin" name="isin" placeholder="Search by ISIN number" value="@currentIsin" />
                <input class="input" type="text" id="companyId" name="companyId" placeholder="Search by company Id" value="@currentId" />
                <button type="submit" class="btn btn-primary">Filter</button>
            </form>
        </div>

        @if (Model != null && Model.Any())
        {
            <table class="table table-striped table-hover">
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>Name</th>
                        <th>Exchange</th>
                        <th>Ticker</th>
                        <th>ISIN</th>
                        <th>Website</th>
                        <th>Action</th>
                    </tr>
                </thead>
                <tbody>
                    @foreach (var company in Model)
                    {
                        <tr>
                            <td>@company.Id</td>
                            <td>
                                <a asp-controller="Home" asp-action="Details" asp-route-id="@company.Id">
                                    @company.Name
                                </a>
                            </td>
                            <td>@company.Exchange</td>
                            <td>@company.StockTicker</td>
                            <td>@company.ISIN</td>
                            <td>
                                @if (!string.IsNullOrWhiteSpace(company.WebsiteURL))
                                {
                                    <a href="@company.WebsiteURL" target="_blank">@company.WebsiteURL</a>
                                }
                            </td>
                            <td>
                                <form asp-action="DeleteCompany" asp-route-id="@company.Id" method="post" style="display:inline;">
                                    @Html.AntiForgeryToken()
                                    <button type="submit" class="delete-x btn btn-link p-0" title="Delete">&times;</button>
                                </form>
                            </td>
                        </tr>
                    }
                </tbody>
            </table>
        }
        else
        {
            <div class="mt-3">
                <span>No companies available to display.</span>
            </div>
        }
    </div>

    <script>
        function createCompany() {
            window.location.href = '@Url.Action("CreateCompany", "Home")';
        }
    </script>
</body>
</html>
